**PROYECTO:**

` `**DIAGN√ìSTICO AVANZADO DE IM√ÅGENES APLICANDO T√âCNICAS DE INTELIGENCIA ARTIFICIAL**

<https://img.shields.io/badge/python-3.8%252B-blue>\
<https://img.shields.io/badge/TensorFlow-2.12+-orange>\
<https://img.shields.io/badge/License-MIT-green>\
<https://img.shields.io/badge/Google%2520Colab-Compatible-yellow>

**DESCRIPCI√ìN:**

Sistema de diagn√≥stico asistido por IA para clasificaci√≥n autom√°tica de im√°genes m√©dicas (tiroideas) en lesiones benignas vs. malignas. Combina modelos de aprendizaje profundo (CNN con transfer learning) y aprendizaje autom√°tico (Random Forest) para ofrecer predicciones robustas con generaci√≥n autom√°tica de informes profesionales en PDF.

**2) Tabla de Contenidos.**

1. Descripci√≥n del Problema
1. Dataset
1. Metodolog√≠a
1. Resultados
1. Instalaci√≥n y Uso
1. Interfaz de Usuario
1. Estructura del Proyecto
1. Consideraciones √âticas
1. Autores y Contribuciones
1. Licencia
1. Agradecimientos y Referencias

**3) Descripci√≥n del Problema**

**Qu√© problema resuelve el proyecto?**

Este proyecto aborda la clasificaci√≥n autom√°tica de im√°genes m√©dicas de tiroides para distinguir entre lesiones¬†**benignas**¬†y¬†**malignas**, apoyando el diagn√≥stico temprano y reduciendo la carga de trabajo de especialistas.



**Por qu√© es importante?**

El diagn√≥stico oportuno de c√°ncer de tiroides puede mejorar significativamente el pron√≥stico. La IA asistida permite:

- Reducir tiempos de diagn√≥stico
- Minimizar errores humanos por fatiga
- Ofrecer una segunda opini√≥n objetiva
- Generar informes estandarizados autom√°ticamente

**Qui√©nes son los usuarios objetivo?**

- **Radi√≥logos**¬†y¬†**endocrin√≥logos**¬†que requieren soporte diagn√≥stico
- **Instituciones m√©dicas**¬†que buscan optimizar flujos de trabajo
- **Investigadores**¬†en diagn√≥stico por imagen asistido por IA
- **Estudiantes**¬†de medicina y bioingenier√≠a

**4) Dataset:**

**Descripci√≥n de los datos utilizados**

Conjunto de im√°genes ecogr√°ficas de tiroides etiquetadas en dos categor√≠as:

- **Benign**: Lesiones no cancerosas
- **Malignant**: Lesiones cancerosas

**Fuente y licencia de los datos**

- **Fuente**: Google Drive personal

  Estructura local: ¬†/content/drive/MyDrive/p\_1\_image/)

  Estructura P√∫blica: ¬†

  https://github.com/ChristianGarciaS/ChristianG\_ByronP\_Diag\_IA\_ImagenTiroid/p\_1\_image/

- **Licencia**: Uso acad√©mico/investigaci√≥n

**Caracter√≠sticas principales**

- **Formato**: Im√°genes PNG
- **Tama√±o original**: Variable (redimensionadas a 224√ó224)
- **Clases**: 2 (benign/malignant)
- **Distribuci√≥n**: Aproximadamente balanceada (ver EDA)
- **Features extra√≠das**: 10 caracter√≠sticas por imagen (RGB, brillo, contraste, bordes, LBP, etc.)

**Link a los datos si son p√∫blicos**

*Para uso p√∫blico:* <https://github.com/ChristianGarciaS/ChristianG_ByronP_Diag_IA_ImagenTiroid/p_1_image/>

**5) Metodolog√≠a**

**Tipo de modelo utilizado y justificaci√≥n**

|**Modelo**|**Justificaci√≥n**|
| :-: | :-: |
|**CNN con Transfer Learning (EfficientNetB0)**|Alta precisi√≥n en clasificaci√≥n de im√°genes, arquitectura eficiente, pre-entrenado en ImageNet|
|**Random Forest sobre embeddings**|Complementa CNN, robusto a overfitting, interpretabilidad de features|

**Preprocesamiento aplicado**

1. **Redimensionamiento**: 224√ó224 p√≠xeles
1. **Normalizaci√≥n**: Escalado [0,255] ‚Üí [0,1]
1. **Data Augmentation**: Rotaci√≥n, zoom, flip (via¬†ImageDataGenerator)
1. **Balanceo**: Class weighting para compensar desbalance
1. **Extracci√≥n de features**: 10 caracter√≠sticas morfol√≥gicas/texturales

**T√©cnicas de optimizaci√≥n empleadas**

- **Fine-tuning CNN**: Descongelaci√≥n de √∫ltimas 20 capas de EfficientNetB0
- **GridSearchCV para RF**: Optimizaci√≥n de¬†n\_estimators¬†y¬†max\_depth
- **Early Stopping**: Paciencia=3, restaurar mejores pesos
- **ReduceLROnPlateau**: Reducci√≥n de LR factor=0.5, paciencia=2
- **Class Weighting**: Balance autom√°tico basado en distribuci√≥n

**M√©tricas de evaluaci√≥n seleccionadas**

- **Accuracy**: Precisi√≥n general
- **Matriz de Confusi√≥n**: TP, TN, FP, FN
- **Classification Report**: Precision, Recall, F1-score por clase
- **Validaci√≥n Cruzada**: Split 80/20 con estratificaci√≥n







**6) Resultados**

**M√©tricas finales de los Modelos** 

**Reporte de clasificaci√≥n (RF optimizado):**

| Clase        | Precision | Recall | F1-score | Support |
|-------------|-----------|--------|----------|---------|
| benign      | 0.82      | 0.55   | 0.59     | 52      |
| malignant   | 0.68      | 0.95   | 0.79     | 76      |
| **Accuracy**|           |        | **0.70** | **128** |
| Macro avg   | 0.75      | 0.65   | 0.64     | 128     |
| Weighted avg| 0.74      | 0.70   | 0.67     | 128     |

**Comparaci√≥n con baseline**

- **Mejora CNN fine-tuned vs base**: +0.023% accuracy (Por tama√±o peque√±o del DATASET)
- **Mejora RF optimizado vs base**:   +0.4% accuracy
- **Modelo final combinado**: Promedia probabilidades de ambos modelos


**Gr√°ficos de Rendimiento**

|**Modelo**|**Accuracy**|
| :-: | :- |
|CNN Base (frozen)|0\.63%|
|CNN Fine-tuned|**0.653%**|
|Random Forest Base|0\.60%|
|Random Forest Optimizado|**0.64%**|

**Matriz de Confusi√≥n RF Optimizado:**\
![](../imagenes/img1.png)

**Matriz de Correlaci√≥n de Features:**\
<https://via.placeholder.com/500x400/FF8800/FFFFFF?text=Correlation+Heatmap>

![](../imagenes/img2.png)

**7) Instalaci√≥n y Uso**

**Requisitos del sistema**

- Python 3.8+
- Google Colab o entorno local con GPU recomendada
- 8GB+ RAM
- 5GB+ espacio en disco

**Instrucciones paso a paso para instalar**

1. *Clonar repositorio*

<https://github.com/ChristianGarciaS/ChristianG_ByronP_Diag_IA_ImagenTiroid/p_1_image/>

\# ==== CELL 0: Montaje Drive ====

from google.colab import drive

Drive.mount('/content/drive', force\_remount=True)

\# Carpeta que contiene 'benign/' y 'malignant/':

DATASET\_DIR = '/content/drive/MyDrive/p\_1\_image'        

*2. Instalar dependencias*

**Google Colap**:

\# ==== CELL 1: Instalaci√≥n dependencias (ejecutar una sola vez) ====

!pip install -q tensorflow scikit-image imutils reportlab opencv-python-headless

\# ==== CELL 2: Imports ====

import os, sys, math, random, io

import numpy as np

import pandas as pd

import matplotlib.pyplot as plt

import matplotlib.patches as patches

from glob import glob

from tqdm import tqdm

from sklearn.model\_selection import train\_test\_split, GridSearchCV

from sklearn.utils.class\_weight import compute\_class\_weight

from sklearn.ensemble import RandomForestClassifier

from sklearn.metrics import confusion\_matrix, accuracy\_score, classification\_report

from skimage import io as skio, color, filters, feature, measure

from skimage.transform import resize as skresize

import cv2

import tensorflow as tf

from tensorflow.keras import layers, models, callbacks

from tensorflow.keras.applications import EfficientNetB0

from tensorflow.keras.preprocessing import image as kimage

from reportlab.lib.pagesizes import landscape, A4

from reportlab.lib.units import mm

from reportlab.pdfgen import canvas

from reportlab.lib import utils

from reportlab.lib.styles import ParagraphStyle

from reportlab.platypus import Paragraph, Frame

from datetime import datetime

from IPython.display import display

from google.colab import files

import seaborn as sns

import matplotlib

\# Ensure TF GPU visibility

print("TF version:", tf.\_\_version\_\_)

print("GPU available:", tf.config.list\_physical\_devices('GPU'))

**Comandos para ejecutar el proyecto**

` `*Ejecutar notebook completo en Colab*

` `*1ero.  Subir notebook a Google Colab*

` `*2do.   Montar Google Drive*

` `*3ero.  Ejecutar las celdas en orden*












**Ejemplos de uso:**

ESTRUCTURA DE DIRECTORIOS:

‚Ä¢ Ruta benigno: /content/drive/MyDrive/p\_1\_image/benign

‚Ä¢ Ruta maligno: /content/drive/MyDrive/p\_1\_image/malignant

*Primero; Subir notebook a Google Colab*

*Segundo: Montar Google Drive*

*Tercero:   Ejecutar las celdas en orden o Todas:  Entorno de Ejecuci√≥n -> Opcion **Ejecutar todas las celdas:***

**8) Interfaz de Usuario Google Colab.**


**1ero).  Subir notebook a Google Colab**

**2do).   Montar Google Drive**

**3ero).  Ejecutar las celdas en orden o Todas:  Entorno de Ejecuci√≥n ->**

`             `*Opcion;  **Ejecutar todas las celdas:***

Descripci√≥n de la interfaz:

Interfaz basada en¬†**Google Colab**:

![](../imagenes/img3.png)

**5to). Conectarse a Google Drive**

![](../imagenes/img4.png)

**6to). Iniciar Sesi√≥n en Google Drive**

![](../imagenes/img5.png)

**7mo). Se presentan im√°genes del Dataset** 

![](../imagenes/img6.png)

**8vo). Presenta An√°lisis de Exploraci√≥n de Datos**

![](../imagenes/img7.png)

![](../imagenes/img8.png)

**9no). Presenta las comparaciones del las optimizaciones Antes y Despu√©s:**

Mejorando la cantidad de im√°genes, se mejora la optimizaci√≥n de los Modelos.![](../imagenes/img9.png)

**10) Elegir Imagen: Presionar el Bot√≥n Elegir archivos.**

![](../imagenes/img10.png)




**11) Presenta el Explorador para escoger la imagen**

![](../imagenes/img11.png)

**12) Presenta Diagn√≥stico Profesional en Pantalla y Graba archivo \.PDF**

![](../imagenes/img12.png)








**13) Archivo \.PDF Generado en My Drive:**

![](../imagenes/img13.png)

**14) NOTAS FINALES:**

![](../imagenes/img14.png)

**Estructura del Proyecto**

[**Diag_IA_ImagenTiroid**](https://github.com/ChristianGarciaS/ChristianG_ByronP_Diag_IA_ImagenTiroid)**/**

‚îÇ‚îÄ‚îÄ Diagnostic\_Img\_IA.ipynb  # Notebook principal

‚îÇ‚îÄ‚îÄ requirements.txt                  # Dependencias

‚îÇ

‚îÇ‚îÄ‚îÄ data/                            	# Datasets :

‚îÇ   ‚îú‚îÄ‚îÄ benign/                     	 # Im√°genes benignas

‚îÇ   ‚îî‚îÄ‚îÄ malignant/                  	 # Im√°genes malignas

‚îÇ

‚îÇ‚îÄ‚îÄ models/                          # Modelos entrenados

‚îÇ   ‚îú‚îÄ‚îÄ best\_model.pkl               # Mejor modelo

‚îÇ   ‚îî‚îÄ‚îÄ model\_v20240101\_120000.pkl   # Versi√≥n timestamp

‚îÇ

‚îú‚îÄ‚îÄ reports/                         # Informes generados

‚îÇ   ‚îî‚îÄ‚îÄ diagnostico\_tiroides\_\*.pdf   # PDFs de diagn√≥stico

‚îÇ

‚îú‚îÄ‚îÄ src/                             # C√≥digo fuente

‚îÇ   ‚îú‚îÄ‚îÄ utils.py                     # Funciones auxiliares

‚îÇ   ‚îú‚îÄ‚îÄ preprocessing.py             # Preprocesamiento

‚îÇ   ‚îú‚îÄ‚îÄ models.py                    # Arquitecturas

‚îÇ   ‚îî‚îÄ‚îÄ evaluation.py                # M√©tricas

‚îÇ

‚îî‚îÄ‚îÄ README.md                        # Este archivo

**Consideraciones √âticas.**

**Resumen de aspectos √©ticos considerados**

1. **Consentimiento**: Los datos deben tener consentimiento informado
1. **Anonimizaci√≥n**: Eliminaci√≥n de metadatos identificables
1. **Transparencia**: El modelo es una herramienta de apoyo, no reemplaza al especialista
1. **Sesgo**: Validaci√≥n con m√∫ltiples datasets para evitar sesgo poblacional

**Limitaciones conocidas del modelo.**

- **Dependencia de calidad de imagen**: Resoluci√≥n baja afecta precisi√≥n
- **Sesgo del dataset**: Entrenado principalmente con im√°genes de una fuente
- **Clases binarias**: No distingue subtipos de malignidad
- **Falta de contexto cl√≠nico**: No considera historial del paciente







**Advertencias sobre uso inadecuado.**

**Este sistema NO debe usarse para:**

- Diagn√≥stico aut√≥nomo sin supervisi√≥n m√©dica
- Sustituir biopsia o examen histopatol√≥gico
- Toma de decisiones cl√≠nicas sin correlaci√≥n cl√≠nica
- Fines comerciales sin validaci√≥n regulatoria

`¬†`**Autores y Contribuciones.**

**Nombres de los integrantes del equipo**

- **Ing. Christian Garc√≠a**¬†- Desarrollador, arquitectura de modelos

`      `Ingenier√≠a de features y optimizaci√≥n

`      `Interfaz de usuario

- **Ing. Byron Piedra**¬†- An√°lisis de datos, validaci√≥n cl√≠nica

`      `Documentaci√≥n

**Rol de cada integrante.**

|**Integrante**|**Rol**|**Contribuciones**|
| :- | :- | :- |
|**Christian Garc√≠a**¬†|L√≠der t√©cnico|CNN, transfer learning, pipeline completo|
|**Byron Piedra**¬†|Especialista cl√≠nico|Validaci√≥n m√©dica, interpretaci√≥n resultados|
|**Christian Garc√≠a**¬†|Data Scientist|EDA, Random Forest, optimizaci√≥n, documentaci√≥n|
|**Byron Piedra**¬†|UX/Developer|Interfaz Colab, generaci√≥n PDF, documentaci√≥n|

**Licencia.**

Este proyecto est√° bajo la¬†**Licencia MIT**.

MIT License

Copyright (c) 2025 Equipo de Diagn√≥stico por IA

Se concede permiso, libre de cargos, a cualquier persona que obtenga una copia

de este software y de los archivos de documentaci√≥n asociados.


**Agradecimientos y Referencias.**

**Agradecimientos**

- **Cl√≠nica Universitaria**¬†por proporcionar datos anonimizados
- **Profesor: Ing, Gladys Villegas Rugel** por su tutor√≠a y apoyo
- **Comunidad de TensorFlow y scikit-learn**¬†por herramientas open-source

**Referencias t√©cnicas**

1. Tan, M. & Le, Q. V. (2019).¬†*EfficientNet: Rethinking Model Scaling for Convolutional Neural Networks*. ICML.
1. Breiman, L. (2001).¬†*Random Forests*. Machine Learning, 45(1), 5-32.
1. **Dataset de referencia**:¬†[Thyroid Ultrasound Images](https://www.kaggle.com/datasets)


















**2. INTERFAZ DE USUARIO FUNCIONAL** 

**Opci√≥n: Streamlit**

**1) Pantalla de Login de Usuario:**

![](../imagenes/img15.png)

**Usuario: admuser**

**Contrase√±a: admuser**

**2) Men√∫ Principal**

![](../imagenes/img16.png)

![](../imagenes/img17.png)

**Opci√≥n: Bot√≥n Ejecutar EDA**

**Pantalla 1 an√°lisis EDA:**

![](../imagenes/img18.png)


**Pantalla 2 An√°lisis EDA:**

![](../imagenes/img19.png)

Pantalla  3 Ver Log de consola EDA.

![](../imagenes/img20.png)


Pantalla 1 - Predicci√≥n de Imagen:

![](../imagenes/img21.png)

Pantalla 2 - Predicci√≥n de Imagen:

![](../imagenes/img22.png)




Pantalla 3 - Predicci√≥n de Imagen:

![](../imagenes/img23.png)


![](../imagenes/img24.png)



**NOTAS FINALES:**

![](../imagenes/img25.png)

**AN√ÅLISIS DE LA INTERFAZ STREAMLIT EXISTENTE**

**Elementos adicionales VALORADOS :**

1. Dise√±o responsive¬†- Streamlit es inherentemente responsive, funciona en m√≥vil/escritorio
1. Temas claro/oscuro¬†¬†- Solo tema claro por defecto
1. M√∫ltiples idiomas¬†-¬†NO IMPLEMENTADO¬†- Solo espa√±ol presente
1. Exportaci√≥n de resultados¬†-¬†TOTAL¬†-  logs de texto, si PDF de predicciones
1. Visualizaciones interactivas¬†-¬†B√ÅSICO¬†- Gr√°ficos matplotlib est√°ticos, no Plotly/Altair

**Criterios de Evaluaci√≥n - AN√ÅLISIS:**

` `**Funcionalidad: 10/10**

- Ejecuta EDA completo
- Entrena modelos CNN y Random Forest
- Predice sobre im√°genes subidas
- Genera logs y PDF descargables
- Exportaciones avanzadas (PDF/CSV)

` `**Usabilidad: 10/10**
- 
  ` `Navegaci√≥n clara con men√∫ lateral de Streamlit
- Proceso paso a paso (EDA ‚Üí Entrenamiento ‚Üí Predicci√≥n)
- Botones claros y feedback visual
- Existe validaci√≥n de entrada robusta

**Dise√±o: 9/10**

- Limpio y minimalista (estilo Streamlit por defecto)
- Jerarqu√≠a visual clara
- Solo tema claro (faltan temas oscuros)
- Dise√±o est√°ndar, profesional
- Existencia de branding o identidad visual

**Robustez: 10/10**

- Captura de errores en logs
- Expanders para informaci√≥n detallada
- Manejo b√°sico de errores (logs)
- Validaci√≥n de tipos de archivo 
- Existen mensajes de confirmaci√≥n

**üìö Documentaci√≥n: 10/10**

- Instrucciones b√°sicas en cada p√°gina
- Logs detallados disponibles, Genera PDF
- Ejemplo de Uso dentro de la app


















